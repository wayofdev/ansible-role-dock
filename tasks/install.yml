---

- name: Dockutil | Check if app is already installed
  ansible.builtin.command: dockutil -V
  register: dockutil_version_output
  ignore_errors: true
  changed_when: false
  tags:
    - dock-install

- name: Dockutil | Should we install
  ansible.builtin.set_fact:
    dockutil_install: "{{ dockutil_version_output.rc > 0 }}"
  tags:
    - dock-install

- name: Dockutil | Debug task
  ansible.builtin.debug:
    msg: "Existing dockutil binary in system: {{ dockutil_install | ternary(false,true) }}"
  tags:
    - dock-install

- name: Dockutil | Install for macOS using brew
  community.general.homebrew:
    name: "{{ dockutil.tap }}"
    state: present
    update_homebrew: true
  when: dockutil_install
  tags:
    - dock-install
