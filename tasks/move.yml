---

- name: Dockutil | Get information on items to move
  ansible.builtin.shell: "{{ dockutil_path }} -f '{{ item.label }}'"
  register: to_move
  loop: "{{ dockutil.dockitems | selectattr('action', 'equalto', 'move') }}"
  changed_when: false
  failed_when: >
    "No such file or directory" in to_move.stdout
    or "command not found" in to_move.stdout
    or "was not found in" in to_move.stdout
  tags:
    - dock-move

- name: Dockutil | Moving items
  ansible.builtin.shell: "{{ lookup('template', './templates/move.j2') | replace('\n', '') | trim }}"
  loop_control:
    label: "{{ item.item }}"
  changed_when: false
  when: dockitems_to_move is defined
  tags:
    - dock-move
